local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local targetCF = CFrame.new(
    730.740051, 130.101242, -179.358292,
    0.323141426, 3.42042483e-08, -0.946350694,
    3.84099401e-08, 1, 4.92587908e-08,
    0.946350694, -5.22668309e-08, 0.323141426
)
local warpDuration = 3

local farming = false
local noclipConn
local startTime = 0

local function formatTime(sec)
    local h = math.floor(sec / 3600)
    local m = math.floor((sec % 3600) / 60)
    local s = sec % 60
    return string.format("%02d:%02d:%02d", h, m, s)
end

local function getHRP()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    return char:WaitForChild("HumanoidRootPart")
end

local function smoothWarp(cf, duration)
    local hrp = getHRP()
    local tweenInfo = TweenInfo.new(duration or 2, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = cf})
    tween:Play()
    tween.Completed:Wait()
end

local function fireTouch(part)
    local hrp = getHRP()
    if part and part:IsA("BasePart") then
        firetouchinterest(hrp, part, 0)
        task.wait(0.1)
        firetouchinterest(hrp, part, 1)
    end
end

local function triggerCheckpoint(i, cpStat, checkpointsFolder)
    local cp = checkpointsFolder:FindFirstChild("Checkpoint"..i)
    if not cp then return end
    local success = false
    while not success and farming do
        local before = cpStat.Value
        fireTouch(cp)
        local timeout, t = 5, 0
        while cpStat.Value == before and t < timeout do
            task.wait(0.2)
            t += 0.2
        end
        if cpStat.Value >= i then
            success = true
        else
            task.wait(0.5)
        end
    end
end

local function triggerCheckpoints()
    local leaderstats = LocalPlayer:WaitForChild("leaderstats")
    local cpStat = leaderstats:WaitForChild("Checkpoint")
    local checkpointsFolder = workspace:WaitForChild("Checkpoints")
    for i = 1, 5 do
        if cpStat.Value < i then
            triggerCheckpoint(i, cpStat, checkpointsFolder)
        end
    end
end

local function triggerSummit()
    local leaderstats = LocalPlayer:WaitForChild("leaderstats")
    local summitStat = leaderstats:WaitForChild("Summit")
    local summit = workspace:FindFirstChild("SummitTrigger")
    if not summit then return false end
    local success = false
    while not success and farming do
        local before = summitStat.Value
        fireTouch(summit)
        local timeout, t = 5, 0
        while summitStat.Value == before and t < timeout do
            task.wait(0.2)
            t += 0.2
        end
        if summitStat.Value > before then
            success = true
        else
            task.wait(0.5)
        end
    end
    return success
end

local function respawnPlayer(resetTimer)
    task.wait(1)
    local char = LocalPlayer.Character
    if char then char:BreakJoints() end
    resetTimer()
end

local function enableNoClip()
    noclipConn = RunService.Stepped:Connect(function()
        local char = LocalPlayer.Character
        if char then
            for _, part in pairs(char:GetChildren()) do
                if part:IsA("BasePart") then part.CanCollide = false end
            end
        end
    end)
end
local function disableNoClip()
    if noclipConn then noclipConn:Disconnect() noclipConn = nil end
end

local function startFarming(updateProgress, updateTimer, resetTimer, blackScreen)
    farming = true
    enableNoClip()
    blackScreen.Visible = true
    resetTimer()
    while farming do
        smoothWarp(targetCF, warpDuration)
        task.wait(0.5)
        triggerCheckpoints()
        task.wait(0.5)
        local summitOK = triggerSummit()
        if summitOK then
            respawnPlayer(resetTimer)
        end
        updateProgress()
        task.wait(5)
    end
    disableNoClip()
    blackScreen.Visible = false
end
local function stopFarming(blackScreen, resetTimer)
    farming = false
    disableNoClip()
    blackScreen.Visible = false
    resetTimer()
end

local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "FarmingGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true

local BlackScreen = Instance.new("Frame", ScreenGui)
BlackScreen.Size = UDim2.new(1, 0, 1, 0)
BlackScreen.Position = UDim2.new(0, 0, 0, 0)
BlackScreen.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
BlackScreen.Visible = false
BlackScreen.ZIndex = 9999

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 200, 0, 120)
Frame.Position = UDim2.new(0.5, -100, 0.1, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.Active = true
Frame.Draggable = true
Frame.ZIndex = 10000
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)

local Button = Instance.new("TextButton", Frame)
Button.Size = UDim2.new(1, -20, 0, 30)
Button.Position = UDim2.new(0, 10, 0, 10)
Button.Text = "ENABLE"
Button.TextColor3 = Color3.fromRGB(255, 255, 255)
Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Button.Font = Enum.Font.GothamBold
Button.TextSize = 18
Button.ZIndex = 10000
Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 6)

local ProgressLabel = Instance.new("TextLabel", Frame)
ProgressLabel.Size = UDim2.new(1, -20, 0, 20)
ProgressLabel.Position = UDim2.new(0, 10, 0, 45)
ProgressLabel.Text = "CP: 0/5 | Summit: 0"
ProgressLabel.TextColor3 = Color3.fromRGB(150, 200, 255)
ProgressLabel.BackgroundTransparency = 1
ProgressLabel.Font = Enum.Font.Gotham
ProgressLabel.TextSize = 15
ProgressLabel.ZIndex = 10000

local TimerLabel = Instance.new("TextLabel", Frame)
TimerLabel.Size = UDim2.new(1, -20, 0, 20)
TimerLabel.Position = UDim2.new(0, 10, 0, 70)
TimerLabel.Text = "Time: 00:00:00"
TimerLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
TimerLabel.BackgroundTransparency = 1
TimerLabel.Font = Enum.Font.Gotham
TimerLabel.TextSize = 15
TimerLabel.ZIndex = 10000

-- Watermark dengan glow samar
local Watermark = Instance.new("TextLabel", ScreenGui)
Watermark.Size = UDim2.new(1, 0, 0, 50)
Watermark.Position = UDim2.new(0.5, 0, 0.5, 0)
Watermark.AnchorPoint = Vector2.new(0.5, 0.5)
Watermark.Text = "CREATED BY\n- VEET -"
Watermark.TextColor3 = Color3.fromRGB(255, 255, 255)
Watermark.TextTransparency = 0.15
Watermark.Font = Enum.Font.GothamBold
Watermark.TextSize = 28
Watermark.BackgroundTransparency = 1
Watermark.ZIndex = 10001
Watermark.TextYAlignment = Enum.TextYAlignment.Center

local stroke = Instance.new("UIStroke", Watermark)
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(255, 255, 255)
stroke.Transparency = 0.7

local function updateProgress()
    local leaderstats = LocalPlayer:FindFirstChild("leaderstats")
    if leaderstats then
        local cp = leaderstats:FindFirstChild("Checkpoint")
        local summit = leaderstats:FindFirstChild("Summit")
        if cp and summit then
            ProgressLabel.Text = "CP: "..cp.Value.."/5 | Summit: "..summit.Value
        end
    end
end

local function resetTimer()
    startTime = tick()
    TimerLabel.Text = "Time: 00:00:00"
end
local function updateTimer()
    if farming and startTime > 0 then
        local elapsed = math.floor(tick() - startTime)
        TimerLabel.Text = "Time: "..formatTime(elapsed)
    end
end

Button.MouseButton1Click:Connect(function()
    if farming then
        stopFarming(BlackScreen, resetTimer)
        Button.Text = "ENABLE"
        Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    else
        Button.Text = "DISABLE"
        Button.BackgroundColor3 = Color3.fromRGB(120, 40, 40)
        task.spawn(function()
            startFarming(updateProgress, updateTimer, resetTimer, BlackScreen)
        end)
    end
end)

RunService.Heartbeat:Connect(function()
    if farming then
        updateProgress()
        updateTimer()
    end
end)